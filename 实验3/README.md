# 实验3

**key word:** shared memory, PV, sem_init, sem_open, interprocess communication



## 实验内容：

创建多个共享内存，组成一个环形缓冲区，两个进程 writebuffer、readbuffer 分别从文件从读取内容写入共享内存，共享内存中读取内容写入文件，实现文件复制的功能，还需使用信号灯进行读写控制。

```
main() { 
	创建共享内存组； 
	创建信号灯； 
	信号灯赋初值； 
	创建两个进程readbuf、writebuf; 
	等待两个进程运行结束； 
	删除信号灯； 
	删除共享内存组； 
}
```

## 实验过程：

与上述过程基本一致

## 实验结果：

自行测试代码

## 实验收获：

创建信号量时，有两种信号量 POSIX 信号量和 SYSTEM Y 信号量。POSIX 信号量操作起来更简单（本实验使用的就是这个），SYSTEM Y 信号量相对会复杂一点，但使用起来更严谨，也更安全（不易出错），<u>仅个人见解</u>。

还有，**在使用需要手动销毁的，一定要在程序结束前手动销毁**，运行第一次可能不会出现问题，但是后面会出问题的。

在初始化信号量时，使用 `sem_init()` 将其第二个参数设置为0，表示本进程内共享，即多个线程之间可以共享本信号量；如果要想在多进程之间共享本信号量，需要将本值设为1（但本人测试并未成功），其后选择了使用 `sem_open()` 进行初始化。

> `sem_init() `创建的无名信号量，是基于程序的；
>
> `sem_open()` 创建的是有名信号量，是基于内存的。



**<u>最后，有任何问题可联系我 641889918@qq.com</u>**